import { useState } from "react";

import { Text, View, Alert } from "react-native";

import { Button, Divider, Card } from "../../ui";
import { styles } from "./styled";

import { colors, spaces } from "../../constant";

const PostingCard = ({ asset }) => {
  const { title, hours, cost, type, dateRange, techStack, signedUp } = asset;
  const [status, setStatus] = useState(signedUp);
  const renderAssetTech = () =>
    techStack.map((tech, index) => {
      return (
        <View key={index} style={styles.assetTech}>
          <Text>{tech}</Text>
        </View>
      );
    });

  const renderSignUpAlert = () => {
    Alert.alert("Confirm", `Sign up for ${title}`, [
      {
        text: "Cancel",
        onPress: () => console.log("Cancel Pressed"),
        style: "cancel",
      },
      { text: "Confirm", onPress: () => setStatus(!status) },
    ]);
  };
  const renderCancelSignUpAlert = () => {
    Alert.alert("Cancelling", title, [
      {
        text: "Cancel",
        onPress: () => console.log("Cancel Pressed"),
        style: "cancel",
      },
      { text: "OK", onPress: () => setStatus(!status) },
    ]);
  };

  const conditionalRenderActionButton = () => {
    if (status) {
      return (
        <Button
          variant="cancel"
          text="Cancel Sign up"
          style={styles.signUpButton}
          onPress={renderCancelSignUpAlert}
        />
      );
    }
    return (
      <Button
        variant="primary"
        text="Signup"
        style={styles.signUpButton}
        onPress={renderSignUpAlert}
      />
    );
  };
  return (
    <Card>
      <View style={styles.rowContainer}>
        <Text style={styles.title}>{title}</Text>
        <View style={styles.assetTimeCostContainer}>
          <Text style={styles.title}>{hours}</Text>
          <Divider />
          <Text style={styles.title}>{cost}</Text>
        </View>
      </View>

      <View style={styles.rowContainer}>
        <View style={styles.assetTypeTag}>
          <Text style={{ color: "white" }}>{type}</Text>
        </View>
        <Text style={{ fontSize: 20, color: colors.darkGrey }}>
          {dateRange}
        </Text>
      </View>

      <View style={{ flexDirection: "row", marginBottom: spaces.medium }}>
        {renderAssetTech()}
      </View>

      {conditionalRenderActionButton()}
    </Card>
  );
};

export { PostingCard };
